import threading
from SocketServer import ThreadingUDPServer, DatagramRequestHandler
import time
#from threading import Thread
from KThread import *

MALWARE_CENTER_IP   = "1.2.1.1"
MALWARE_CENTER_PORT = 56566



class Malware_request_handler( DatagramRequestHandler ):
    def handle(self):
        data = self.rfile.read()
        print("new worm instance " + str(data))
#        if data == "shutdown":
#

def start_malware_center(ip="localhost", port=56565):
    server = ThreadingUDPServer((ip, port), Malware_request_handler)
    server.allow_reuse_address = True
    print("server started\n")
    server.serve_forever()


if __name__ == "__main__":
    server_thread = KThread(target=start_malware_center, args=(MALWARE_CENTER_IP,MALWARE_CENTER_PORT))
#    server_thread.daemon = True
    server_thread.start()
#    server_thread.kill()








